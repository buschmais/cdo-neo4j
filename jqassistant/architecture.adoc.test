[[architecture:Default]]
[role=group]
== Architectural Rules

This section describes rules regarding the architecture of eXtended Objects.

=== Framework Modules

The framework consists of the following modules:

xo.api::
  The client API of eXtended Ojects
xo.spi::
  The service provider interface which is implemented by datastores.
xo.impl::
  The implementation of the API using the SPI

[[architecure:Framework]]
[source,cypher,role=concept]
.Adds the labels `Module` and `Framework` to the framework artifacts created by Maven.
----
MATCH
   (:Maven:Project)-[:CREATES]->(framework:Artifact)
WHERE
  framework.type <> "test-jar"
  and framework.name in [
    "xo.api",
    "xo.spi",
    "xo.impl"
  ]
SET
  framework:Framework:Module
RETURN
  framework
----

[[architecture:FrameworkDependencyDefinition]]
[source,cypher,role=concept,requiresConcepts="architecture:Framework"]
.Defines the allowed dependencies between the framework artifacts.
----
MATCH
  (api:Framework:Module{name:"xo.api"}),
  (spi:Framework:Module{name:"xo.spi"}),
  (impl:Framework:Module{name:"xo.impl"})
MERGE
  (spi)-[:DEFINES_DEPENDENCY]->(api),
MERGE
  (impl-[:DEFINES_DEPENDENCY]->(api),
MERGE
  (impl-[:DEFINES_DEPENDENCY]->(spi)
RETURN
  *
----

